---
title: "Get a list of all extension attributes from an Azure B2C tenant"
description: "This is a blog post on how to get the full list of custom attributes that exist in an Azure B2C tenant. This example uses Microsoft Graph API and the client credentials OAuth flow. "
date: "2023-06-26"
draft: false
slug: "get-a-list-of-extension-attributes-from-azure-b2c"
tags:
---

<p><em>I've built an </em><a href="https://github.com/clintmcmahon/azure-ad-b2c-user-manager" rel="noreferrer"><em>entire Azure AD B2C User Management solution</em></a><em> that is available for free on Github. The code samples below are part of this larger solution. Feel free to use this application as you see fit. </em><a href="__GHOST_URL__/contact" rel="noreferrer"><em>Contact me</em></a><em> if you run into any issues or need help consulting on your Azure AD B2C project.</em></p><p>This is a blog post on how to get the full list of custom attributes that exist in an Azure B2C tenant. This example uses Microsoft Graph API and the client credentials OAuth flow. </p><h2 id="register-the-graph-api-app">Register the Graph API app</h2><p>The first thing is sign into your Azure B2C tenant and create a new app registration for the Graph API app. This example uses a separate Azure App Registration to connect to the Graph API. You could use an existing Azure App if you wanted to as well. <a href="__GHOST_URL__/how-to-use-graph-api-to-query-azure-ad-b2c-users-using-postman/">These instructions are similar to the set up that for getting a list of users for a B2C tenant</a>. Follow these steps to create a new Graph API app in your Azure environment if you have not already done so. </p><ol><li>Switch to your B2C Tenant directory</li><li>Go to Azure AD B2C</li><li>Select <strong>App registrations</strong> in the Manage section</li><li>Create a <strong>New registration</strong></li><li>Give your app a name. I named mine <strong>B2C Graph API</strong>. Click save and make a copy of the newly created <strong>Client Id</strong>.</li><li>Click <strong>Certificates &amp; secrets</strong> and create a <strong>New client secret</strong>. Give it a descriptive name and set the expiration date. I usually set mine to 6 months.</li><li>Copy the Value of the newly created secret and hold on to it. Store the value in a secret vault or other safe place along with the client id from step 5.</li></ol><h2 id="get-an-access-token-for-the-graph-api-app">Get an access token for the Graph API app</h2><p>Open Postman and create a <code>POST</code> request to the following URL along with the appropriate parameters.</p><p><strong>URL</strong>: <code>https://login.microsoftonline.com/{b2c_tenant_id}/oauth2/v2.0/token</code><br><strong>scope</strong>: <code>https://graph.microsoft.com/.default</code><br><strong>grant_type</strong>: <code>client_credentials</code><br><strong>client_secret</strong>: <code>[Your client secret from the section above]</code><br><strong>client_id</strong>: <code>[Your client id from the section above]</code></p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="/images/2023/06/Screenshot-2023-06-24-at-7.59.11-AM-1.png" class="kg-image" alt="" loading="lazy" srcset="/images/2023/06/Screenshot-2023-06-24-at-7.59.11-AM-1.png 600w, /images/2023/06/Screenshot-2023-06-24-at-7.59.11-AM-1.png 1000w, /images/2023/06/Screenshot-2023-06-24-at-7.59.11-AM-1.png 1600w, /images/2023/06/Screenshot-2023-06-24-at-7.59.11-AM-1.png 2112w" sizes="(min-width: 720px) 720px" sizes="(max-width: 720px) 100vw, 720px" class="kg-image" loading="lazy" style="width: 100%; height: auto; max-width: 100%;"><figcaption><span style="white-space: pre-wrap;">Example get access token from client credentials flow for MS Graph API</span></figcaption></figure><h2 id="get-the-list-of-applications">Get the list of applications</h2><p>Set the <code>access_token</code> generated from the above call as the Bearer Token authorization header parameter to create a <code>GET</code> request to the <code>https://graph.microsoft.com/v1.0/applications</code> endpoint. This endpoint will return a list of all the applications in this tenant. </p><figure class="kg-card kg-image-card"><img src="/images/2023/06/Screenshot-2023-06-24-at-8.01.26-AM.png" class="kg-image" alt="" loading="lazy" srcset="/images/2023/06/Screenshot-2023-06-24-at-8.01.26-AM.png 600w, /images/2023/06/Screenshot-2023-06-24-at-8.01.26-AM.png 1000w, /images/2023/06/Screenshot-2023-06-24-at-8.01.26-AM.png 1600w, /images/2023/06/Screenshot-2023-06-24-at-8.01.26-AM.png 2032w" sizes="(min-width: 720px) 720px" sizes="(max-width: 720px) 100vw, 720px" class="kg-image" loading="lazy" style="width: 100%; height: auto; max-width: 100%;"></figure><p>Find the application with the <code>displayName</code><strong> </strong>equal to <strong>b2c-extensions-app. Do not modify. Used by AADB2C for storing user data </strong>and copy the <code>id</code> and <code>appId</code> property values. For some reason there are two different Id values for the application. In most cases with Azure B2C and AD we deal with the <code>appId</code> but in this case to get this application we need to use the <code>id</code> property.</p><h2 id="list-the-all-b2c-extension-properties-of-this-application">List the all B2C extension properties of this application</h2><p>Using the <code>access_token</code> and the <code>id</code> field from the previous call, create a <code>GET</code> request to the <code>https://graph.microsoft.com/v1.0/applications/{id}/extensionProperties</code> endpoint. This endpoint will return the list of all the extension properties that were created for this application. Here you can see that I have created an extension property called <code>Role</code> that is associated to the user object. The <code>value</code> property is an array, as you create more custom extensions they will populate this array.</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="/images/2023/06/Screenshot-2023-06-24-at-8.16.02-AM.png" class="kg-image" alt="" loading="lazy" srcset="/images/2023/06/Screenshot-2023-06-24-at-8.16.02-AM.png 600w, /images/2023/06/Screenshot-2023-06-24-at-8.16.02-AM.png 1000w, /images/2023/06/Screenshot-2023-06-24-at-8.16.02-AM.png 1600w, /images/2023/06/Screenshot-2023-06-24-at-8.16.02-AM.png 2002w" sizes="(min-width: 720px) 720px" sizes="(max-width: 720px) 100vw, 720px" class="kg-image" loading="lazy" style="width: 100%; height: auto; max-width: 100%;"><figcaption><span style="white-space: pre-wrap;">List of custom Azure B2C extension properties</span></figcaption></figure><p>And in conclusion this is how you get a list of all extension attributes from a Azure B2C tenant using the MS Graph API. It's a little round about having to utilize the <code>id</code> property and not the <code>appId</code> property. </p><p></p>
